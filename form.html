<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Contact Us</title>

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

<style>
:root{
  --bg:#020617;
  --card:rgba(15,23,42,.75);
  --border:rgba(148,163,184,.2);
  --accent:#38bdf8;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --success:#22c55e;
  --error:#ef4444;
}

*{box-sizing:border-box;margin:0;padding:0}

body{
  font-family:Poppins, sans-serif;
  background:radial-gradient(circle at top,#020617,#020617);
  color:var(--text);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}

.contact-card{
  max-width:520px;
  width:100%;
  background:var(--card);
  backdrop-filter:blur(12px);
  border:1px solid var(--border);
  border-radius:16px;
  padding:28px;
  box-shadow:0 20px 40px rgba(0,0,0,.4);
}

.contact-card h2{
  text-align:center;
  margin-bottom:8px;
  font-weight:600;
}

.contact-card p{
  text-align:center;
  font-size:.9rem;
  color:var(--muted);
  margin-bottom:22px;
}

.form-group{
  margin-bottom:16px;
}

label{
  font-size:.85rem;
  margin-bottom:6px;
  display:block;
  color:var(--muted);
}

input, textarea{
  width:100%;
  padding:12px 14px;
  background:#020617#;
  border:1px solid var(--border);
  border-radius:10px;
  color:var(--text);
  font-family:inherit;
  outline:none;
}

input:focus, textarea:focus{
  border-color:var(--accent);
}

textarea{
  resize:none;
  min-height:120px;
}

button{
  width:100%;
  padding:12px;
  border:none;
  border-radius:10px;
  background:linear-gradient(135deg,#38bdf8,#0ea5e9);
  color:#020617;
  font-weight:600;
  cursor:pointer;
  transition:.2s;
}

button:disabled{
  opacity:.6;
  cursor:not-allowed;
}

button:hover:not(:disabled){
  transform:translateY(-1px);
}

.status{
  margin-top:14px;
  font-size:.9rem;
  text-align:center;
}

.success{color:var(--success)}
.error{color:var(--error)}

@media(max-width:480px){
  .contact-card{
    padding:22px;
  }
}
</style>
</head>

<body>

<div class="contact-card">
  <h2>Contact Us</h2>
  <p>Weâ€™d love to hear from you. Fill in the form below.</p>

  <form id="contactForm">
    <div class="form-group">
      <label>Full Name</label>
      <input type="text" name="name" required placeholder="John Doe">
    </div>

    <div class="form-group">
      <label>Email Address</label>
      <input type="email" name="email" required placeholder="you@example.com">
    </div>

    <div class="form-group">
      <label>Subject</label>
      <input type="text" name="subject" required placeholder="Subject">
    </div>

    <div class="form-group">
      <label>Message</label>
      <textarea name="message" required placeholder="Type your message..."></textarea>
    </div>

    <button type="submit" id="sendBtn">Send Message</button>
  </form>

  <div id="status" class="status"></div>
</div>

<script>
const form = document.getElementById("contactForm");
const statusBox = document.getElementById("status");
const btn = document.getElementById("sendBtn");

const SCRIPT_URL = "PASTE_YOUR_WEB_APP_URL_HERE";

form.addEventListener("submit", async (e) => {
  e.preventDefault();

  btn.disabled = true;
  btn.textContent = "Sending...";
  statusBox.textContent = "";
  statusBox.className = "status";

  const data = {
    name: form.name.value.trim(),
    email: form.email.value.trim(),
    subject: form.subject.value.trim(),
    message: form.message.value.trim()
  };

  try{
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await res.json();

    if(result.status === "success"){
      statusBox.textContent = "Message sent successfully. Weâ€™ll get back to you shortly âœ”";
      statusBox.classList.add("success");
      form.reset();
    } else {
      throw new Error();
    }

  } catch(err){
    statusBox.textContent = "Failed to send message. Please try again.";
    statusBox.classList.add("error");
  }

  btn.disabled = false;
  btn.textContent = "Send Message";
});
</script>

<!--Appscript
/*************************************************
 * CONTACT FORM BACKEND + AUTO-REPLY
 *************************************************/
function doPost(e) {
  try {
    const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    const data = JSON.parse(e.postData.contents);

    const time = new Date();
    const name = data.name;
    const email = data.email;
    const subject = data.subject;
    const message = data.message;
    const ip = e.parameter.ip || "Unknown";

    sheet.appendRow([time, name, email, subject, message, ip]);

    // ADMIN EMAIL
    MailApp.sendEmail({
      to: "admin@example.com", // CHANGE THIS
      subject: "New Contact Message: " + subject,
      htmlBody: `
        <h3>New Contact Submission</h3>
        <p><b>Name:</b> ${name}</p>
        <p><b>Email:</b> ${email}</p>
        <p><b>Subject:</b> ${subject}</p>
        <p><b>Message:</b><br>${message}</p>
      `
    });

    // AUTO-REPLY TO USER
    MailApp.sendEmail({
      to: email,
      subject: "We received your message",
      htmlBody: `
        <p>Hello ${name},</p>
        <p>Thank you for contacting us. Weâ€™ve received your message and will get back to you shortly.</p>
        <p><b>Your Message:</b></p>
        <blockquote>${message}</blockquote>
        <br>
        <p>Kind regards,<br><b>Support Team</b></p>
      `
    });

    return ContentService.createTextOutput(
      JSON.stringify({ status: "success" })
    ).setMimeType(ContentService.MimeType.JSON);

  } catch (err) {
    return ContentService.createTextOutput(
      JSON.stringify({ status: "error", message: err.toString() })
    ).setMimeType(ContentService.MimeType.JSON);
  }
}


/*************************************************
 * MANUAL MASS EMAIL FEATURE (ADMIN ONLY)
 *************************************************/

// Add menu when sheet opens
function onOpen() {
  SpreadsheetApp.getUi()
    .createMenu("ðŸ“§ Email Tools")
    .addItem("Send Mass Email", "massEmailPrompt")
    .addToUi();
}

// Prompt admin for subject & message
function massEmailPrompt() {
  const ui = SpreadsheetApp.getUi();

  const subject = ui.prompt(
    "Mass Email",
    "Enter email subject:",
    ui.ButtonSet.OK_CANCEL
  );
  if (subject.getSelectedButton() !== ui.Button.OK) return;

  const body = ui.prompt(
    "Mass Email",
    "Enter email message (HTML allowed):",
    ui.ButtonSet.OK_CANCEL
  );
  if (body.getSelectedButton() !== ui.Button.OK) return;

  sendMassEmail(subject.getResponseText(), body.getResponseText());
}

// Send email to all addresses in the sheet
function sendMassEmail(subject, body) {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  const data = sheet.getDataRange().getValues();

  let sent = 0;

  for (let i = 1; i < data.length; i++) {
    const email = data[i][2]; // Column C = Email

    if (email && email.includes("@")) {
      MailApp.sendEmail({
        to: email,
        subject: subject,
        htmlBody: body
      });
      sent++;
    }
  }

  SpreadsheetApp.getUi().alert(
    `Mass email successfully sent to ${sent} recipients.`
  );
}



<!--customized email template
const currentDate = new Date().toLocaleDateString('en-GB', {
  weekday: 'long',
  day: 'numeric',
  month: 'long',
  year: 'numeric'
});

htmlBody: `
<div style="
  max-width:600px;
  margin:0 auto;
  padding:30px;
  font-family:Arial, Helvetica, sans-serif;
  background:#ffffff;
  border-radius:14px;
  box-shadow:0 10px 30px rgba(0,0,0,0.08);
">

  <h2 style="
    color:#111827;
    margin-bottom:10px;
    font-size:22px;
  ">
    Hello ${name}
  </h2>

  <!-- Date -->
  <p style="
    font-size:13px;
    color:#9ca3af;
    margin-bottom:20px;
  ">
    ${currentDate}
  </p>

  <p style="
    color:#374151;
    font-size:16px;
    line-height:1.6;
    margin-bottom:18px;
  ">
    Thank you for reaching out to us. Weâ€™ve received your message and our team is already reviewing it.
  </p>

  <div style="
    background:#f9fafb;
    padding:16px;
    border-left:4px solid #6366f1;
    border-radius:8px;
    margin-bottom:22px;
  ">
    <p style="
      margin:0;
      color:#4b5563;
      font-size:15px;
    ">
      Expect a response shortly â€” we appreciate your patience.
    </p>
  </div>

  <p style="
    color:#374151;
    font-size:15px;
    margin-bottom:32px;
  ">
    If your request is urgent, feel free to reply directly to this email.
  </p>

  <hr style="
    border:none;
    border-top:1px solid #e5e7eb;
    margin:26px 0;
  " />

  <!-- Signature -->
  <p style="
    color:#6b7280;
    font-size:14px;
    margin-bottom:6px;
  ">
    Kind regards,
  </p>

  <p style="
    font-size:15px;
    font-weight:600;
    color:#111827;
    margin:0;
  ">
    McOwino
  </p>

  <!-- Footer -->
  <div style="
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid #f0f0f0;
  ">

    <p style="
      font-size:12px;
      color:#9ca3af;
      line-height:1.6;
      margin:0 0 10px 0;
    ">
      This email was sent in response to a request made via our platform.
      If you did not initiate this request, please disregard this message.
    </p>

    <p style="
      font-size:12px;
      color:#9ca3af;
      margin:0;
    ">
      Â© ${new Date().getFullYear()} McOwino. All rights reserved.
    </p>

  </div>

</div>


-->

  <!-- Footer -->
  <div style="
    margin-top:26px;
    padding-top:18px;
    border-top:1px solid #f0f0f0;
  ">

    <p style="
      font-size:12px;
      color:#9ca3af;
      line-height:1.6;
      margin:0 0 10px 0;
    ">
      This email was sent in response to a request made via our platform.
      If you did not initiate this request, please disregard this message.
    </p>

    <p style="
      font-size:12px;
      color:#9ca3af;
      margin:0;
    ">
      Â© ${new Date().getFullYear()} McOwino. All rights reserved.
    </p>





https://script.google.com/macros/s/AKfycbzQyHl9ofUmDkKPxc3ix9q_V-oljugupT2pKuTp8OJuquVWQsiukgU3xUwLtaJDKxbxOQ/exec


https://script.google.com/macros/s/AKfycbyntVptvowL8YkE7aH3VHQQlD7VLeKcNVMvnAMVuplcSXxQvItKX9XTdUxwnyUFZ13Q/exec



https://script.google.com/macros/s/AKfycbwGzMCsTO8HUr1HuLv5xc1tPZ4ata3fEQIe_KWzdZhhGaOw6rw3XdEbc-_bm6KTu3fuUQ/exec

https://script.google.com/macros/s/AKfycbxSP-zTVFAr7NQKaPNtuRXoe6KXotUtpvl9dC8Sz8TtltyJDoY6BG-KnqVieSzboXTzlw/exec
-->



</body>
</html>
